Merging Data Sets
================
Hun Lee (sl4836), Jimmy Kelliher (jmk2303), Tanvir Khan (tk2886), Tucker
Morgan (tlm2152), Zachary Katz (zak2132)
11/20/2021

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──

    ## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
    ## ✓ tibble  3.1.2     ✓ dplyr   1.0.7
    ## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
    ## ✓ readr   2.0.1     ✓ forcats 0.5.1

    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(janitor)
```

    ## 
    ## Attaching package: 'janitor'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     chisq.test, fisher.test

Below, we read in monthly death rates and hospitalization rates due to
COVID-19, as well as rates of vaccination against COVID-19, courtesy of
DOHMH. Data are recorded for each Zip Code Tabulation Area (ZCTA) in
NYC, and values denote rates per 100,000 residents of a given ZCTA.
Next, we read in two crosswalks between geographies of NYC, courtesy of
Baruch College. The `zcta_puma_cross.csv` crosswalk enables us to merge
data between ZCTAs and PUMAs, neither of which is a strict sub-geography
of the other. The `zcta_zip_cross.csv` file enables us to aggregate
zip-code-level data to ZCTA-level data.

``` r
death_data <- read_csv("../data/nyc_death_rate_zcta.csv")
hosp_data <- read_csv("../data/nyc_hosp_rate_zcta.csv")
vacc_data <- read_csv("../data/nyc_vacc_zcta.csv")

zcta_puma_cross <- read_csv("../data/zcta_puma_cross.csv")
zcta_zip_cross <- read_csv("../data/zcta_zip_cross.csv")
```

Below, we are calculating the mean death rate and hospitalization rate
for each ZCTA. These data are presented over the time interval from
March 2020 to September 2021. We will take the mean rate across these
months to use in our analysis.

``` r
death_data_clean <-
  death_data %>% 
  janitor::clean_names() %>%
  select(deathrate_10001:deathrate_11697) %>%
  pivot_longer(deathrate_10001:deathrate_11697, 
               names_to = "zcta", 
               values_to = "death_rate", 
               names_prefix = "deathrate_") %>%
  group_by(zcta) %>%
  summarise(death_rate_mean = 
              mean(death_rate, na.rm = T)) # Mean removes NA values here, may want to replace above

rm(death_data) # This removes the raw data, but fine to take out this line of code
```

``` r
hosp_data_clean <- 
  hosp_data %>% 
  janitor::clean_names() %>%
  select(hosprate_10001:hosprate_11697) %>%
  pivot_longer(hosprate_10001:hosprate_11697, 
               names_to = "zcta", 
               values_to = "hosp_rate", 
               names_prefix = "hosprate_") %>%
  group_by(zcta) %>%
  summarise(hosp_rate_mean = 
              mean(hosp_rate, na.rm = T)) # Mean removes NA values here, may want to replace above

rm(hosp_data) # Fine to remove this line of code
```

Below, we clean `vacc_data` and extract only the percentage of partially
or fully vaccinated individuals in each ZCTA as of November 16, 2021.

``` r
vacc_data_clean <- 
  vacc_data %>% 
  janitor::clean_names() %>% 
  select(modzcta, perc_1plus) %>% # We can make changes here if we want to include other variables
  rename(zcta = modzcta) %>% 
  mutate(zcta = as.character(zcta))

rm(vacc_data) # Fine to remove this line of code
```

The cleaned and merged data sets:

``` r
#hospitalization data 
merged_outcomes <- 
  merge(death_data_clean, hosp_data_clean, by = "zcta")

#vaccination data 
merged_outcomes <- 
  merge(merged_outcomes, vacc_data_clean, by = "zcta")

head(merged_outcomes) # One potential issue here is that vaccination rate exceeds 100% in some places
```

    ##    zcta death_rate_mean hosp_rate_mean perc_1plus
    ## 1 10001        12.41429       36.21053     132.18
    ## 2 10002        31.49286       73.88500      88.06
    ## 3 10003         9.27000       23.40526      78.48
    ## 4 10004         0.00000       80.74000     141.68
    ## 5 10005         0.00000       25.27143      97.51
    ## 6 10006         0.00000       53.24000     141.02

Below, the code shows the ZCTA and PUMA ID numbers, `per_in_puma` - the
percentage of the ZCTA in the associated PUMA, and `per_of_puma` - the
percentage of the PUMA that is occupied by the specified ZCTA.

``` r
zcta_puma_clean <-
  zcta_puma_cross %>% 
  mutate(zcta10 = 
           as.character(zcta10)) %>%
  select(zcta10 , puma10, per_in_puma, per_of_puma) %>%
  rename(zcta = zcta10) 

head(zcta_puma_clean)
```

    ## # A tibble: 6 x 4
    ##   zcta  puma10 per_in_puma per_of_puma
    ##   <chr>  <dbl>       <dbl>       <dbl>
    ## 1 10451   3710       0.482       0.141
    ## 2 10451   3708       0.459       0.151
    ## 3 10451   3705       0.059       0.017
    ## 4 10452   3708       0.952       0.515
    ## 5 10452   3707       0.048       0.027
    ## 6 10453   3707       0.984       0.574

``` r
rm(zcta_puma_cross) # Fine to remove this line of code
```

Below, we calculate `weighted_death_rate` and `weighted_hosp_rate` for
each PUMA by the following steps. 1. The `death_rate` or `hosp_rate`
from each ZCTA is multiplied by the percentage of the ZCTA that is in
the corresponding PUMA (`per_in_puma`). 2. The resulting product is then
multiplied by `per_in_puma` which represents the percentage of the total
PUMA that the specified ZCTA occupies. 3. The resulting weighted
products are summed for each PUMA to obtain the total
`weighted_death_rate` and `weighted_hosp_rate` for each PUMA.

``` r
merge(zcta_puma_clean, merged_outcomes, by = "zcta")
```

    ##      zcta puma10 per_in_puma per_of_puma death_rate_mean hosp_rate_mean
    ## 1   10001   3807       1.000       0.146       12.414286       36.21053
    ## 2   10002   3809       1.000       0.494       31.492857       73.88500
    ## 3   10003   3808       0.238       0.088        9.270000       23.40526
    ## 4   10003   3810       0.242       0.091        9.270000       23.40526
    ## 5   10003   3807       0.053       0.021        9.270000       23.40526
    ## 6   10003   3809       0.467       0.159        9.270000       23.40526
    ## 7   10004   3810       1.000       0.021        0.000000       80.74000
    ## 8   10005   3810       1.000       0.048        0.000000       25.27143
    ## 9   10006   3810       1.000       0.020        0.000000       53.24000
    ## 10  10007   3809       0.122       0.005        0.000000       26.00000
    ## 11  10007   3810       0.878       0.041        0.000000       26.00000
    ## 12  10009   3808       0.270       0.110       18.300000       46.60000
    ## 13  10009   3809       0.730       0.272       18.300000       46.60000
    ## 14  10010   3808       0.809       0.170        8.000000       30.44000
    ## 15  10010   3807       0.191       0.042        8.000000       30.44000
    ## 16  10011   3807       0.770       0.271       11.336364       28.98421
    ## 17  10011   3810       0.230       0.078       11.336364       28.98421
    ## 18  10012   3810       1.000       0.161        6.244444       27.25625
    ## 19  10013   3810       0.812       0.151        9.550000       34.69444
    ## 20  10013   3809       0.188       0.032        9.550000       34.69444
    ## 21  10014   3810       0.990       0.212        7.190909       22.26500
    ## 22  10014   3807       0.010       0.002        7.190909       22.26500
    ## 23  10016   3808       0.905       0.325       12.360000       29.16000
    ## 24  10016   3807       0.095       0.036       12.360000       29.16000
    ## 25  10017   3807       0.004       0.000        9.142857       32.44667
    ## 26  10017   3808       0.996       0.109        9.142857       32.44667
    ## 27  10018   3807       1.000       0.036        3.854545       25.96875
    ## 28  10019   3806       0.091       0.020       15.800000       37.97368
    ## 29  10019   3807       0.909       0.269       15.800000       37.97368
    ## 30  10021   3805       1.000       0.198       19.133333       28.12105
    ## 31  10022   3808       0.936       0.198       16.642857       33.08333
    ## 32  10022   3805       0.043       0.006       16.642857       33.08333
    ## 33  10022   3807       0.021       0.005       16.642857       33.08333
    ## 34  10023   3806       1.000       0.315       10.750000       25.07000
    ## 35  10024   3806       1.000       0.306       16.963636       29.46316
    ## 36  10024   3802       0.000       0.000       16.963636       29.46316
    ## 37  10025   3802       0.318       0.236       33.036364       44.31000
    ## 38  10025   3806       0.682       0.333       33.036364       44.31000
    ## 39  10026   3803       0.981       0.281       26.433333       58.96000
    ## 40  10026   3802       0.019       0.005       26.433333       58.96000
    ## 41  10027   3802       0.603       0.283       30.855556       58.20500
    ## 42  10027   3803       0.397       0.200       30.855556       58.20500
    ## 43  10028   3805       1.000       0.205        8.240000       24.31579
    ## 44  10029   3804       1.000       0.646       38.150000       79.45000
    ## 45  10030   3803       0.920       0.209       37.150000       71.75000
    ## 46  10030   3802       0.080       0.017       37.150000       71.75000
    ## 47  10031   3802       1.000       0.443       27.500000       68.86500
    ## 48  10032   3801       0.964       0.279       32.076923       87.54500
    ## 49  10032   3802       0.036       0.016       32.076923       87.54500
    ## 50  10033   3801       1.000       0.272       29.900000       69.55500
    ## 51  10034   3801       1.000       0.196       21.100000       59.89500
    ## 52  10035   3804       0.941       0.272       51.863636      101.45000
    ## 53  10035   3803       0.059       0.017       51.863636      101.45000
    ## 54  10036   3807       1.000       0.171       14.935714       41.84500
    ## 55  10037   3803       0.588       0.086       44.720000       73.81500
    ## 56  10037   3804       0.412       0.061       44.720000       73.81500
    ## 57  10038   3809       0.319       0.039       19.240000       47.24000
    ## 58  10038   3810       0.681       0.093       19.240000       47.24000
    ## 59  10039   3803       1.000       0.207       29.741667       69.71500
    ## 60  10039   3801       0.000       0.000       29.741667       69.71500
    ## 61  10040   3801       1.000       0.211       44.445455       73.35500
    ## 62  10044   3805       1.000       0.053       32.709091       49.80625
    ## 63  10065   3805       1.000       0.147       11.544444       33.39375
    ## 64  10069   3806       1.000       0.027        0.000000       33.79375
    ## 65  10075   3805       1.000       0.119       27.227273       39.05263
    ## 66  10128   3804       0.040       0.021       13.288889       25.15789
    ## 67  10128   3805       0.960       0.264       13.288889       25.15789
    ## 68  10280   3810       1.000       0.053        0.000000       30.76250
    ## 69  10282   3810       1.000       0.032       26.916667       71.78333
    ## 70  10301   3903       0.966       0.218       42.300000       80.06500
    ## 71  10301   3902       0.034       0.010       42.300000       80.06500
    ## 72  10302   3903       1.000       0.109       21.635714       84.12000
    ## 73  10303   3902       0.000       0.000       28.088889       72.41500
    ## 74  10303   3903       1.000       0.150       28.088889       72.41500
    ## 75  10304   3903       0.667       0.160       50.315385       87.86500
    ## 76  10304   3902       0.333       0.106       50.315385       87.86500
    ## 77  10305   3903       0.309       0.073       28.200000       74.55000
    ## 78  10305   3902       0.691       0.217       28.200000       74.55000
    ## 79  10306   3902       0.523       0.220       32.826667       74.90000
    ## 80  10306   3901       0.477       0.167       32.826667       74.90000
    ## 81  10307   3901       1.000       0.088       10.542857       55.51111
    ## 82  10308   3901       1.000       0.171       18.725000       52.42632
    ## 83  10309   3901       1.000       0.203       16.823077       55.59474
    ## 84  10310   3903       1.000       0.142       30.566667       68.27000
    ## 85  10312   3901       1.000       0.371       17.421429       52.00000
    ## 86  10312   3902       0.000       0.000       17.421429       52.00000
    ## 87  10314   3902       0.696       0.447       34.000000       67.06500
    ## 88  10314   3903       0.304       0.148       34.000000       67.06500
    ## 89  10314   3901       0.000       0.000       34.000000       67.06500
    ## 90  10451   3710       0.482       0.141       48.780000       86.45000
    ## 91  10451   3705       0.059       0.017       48.780000       86.45000
    ## 92  10451   3708       0.459       0.151       48.780000       86.45000
    ## 93  10452   3707       0.048       0.027       30.784615       79.57000
    ## 94  10452   3708       0.952       0.515       30.784615       79.57000
    ## 95  10453   3706       0.016       0.010       36.600000       83.50500
    ## 96  10453   3707       0.984       0.574       36.600000       83.50500
    ## 97  10454   3710       1.000       0.239       33.978571       92.92000
    ## 98  10455   3710       1.000       0.254       33.046154       87.25000
    ## 99  10456   3708       0.464       0.288       39.525000       84.83000
    ## 100 10456   3705       0.491       0.264       39.525000       84.83000
    ## 101 10456   3710       0.045       0.025       39.525000       84.83000
    ## 102 10457   3707       0.483       0.254       29.838462       84.04500
    ## 103 10457   3705       0.426       0.186       29.838462       84.04500
    ## 104 10457   3708       0.091       0.046       29.838462       84.04500
    ## 105 10458   3707       0.099       0.059       26.220000       69.92000
    ## 106 10458   3705       0.305       0.150       26.220000       69.92000
    ## 107 10458   3706       0.596       0.372       26.220000       69.92000
    ## 108 10459   3705       0.369       0.108       42.816667       87.84500
    ## 109 10459   3710       0.631       0.191       42.816667       87.84500
    ## 110 10460   3704       0.076       0.035       29.538462       84.34500
    ## 111 10460   3705       0.750       0.266       29.538462       84.34500
    ## 112 10460   3709       0.173       0.055       29.538462       84.34500
    ## 113 10461   3709       0.096       0.027       33.215385       83.29474
    ## 114 10461   3703       0.483       0.212       33.215385       83.29474
    ## 115 10461   3704       0.421       0.172       33.215385       83.29474
    ## 116 10462   3709       0.548       0.229       30.875000       78.80000
    ## 117 10462   3704       0.445       0.272       30.875000       78.80000
    ## 118 10462   3705       0.007       0.003       30.875000       78.80000
    ## 119 10463   3701       0.838       0.527       45.133333       69.88500
    ## 120 10463   3706       0.038       0.020       45.133333       69.88500
    ## 121 10463   3801       0.125       0.043       45.133333       69.88500
    ## 122 10464   3703       0.971       0.038        0.000000       62.20833
    ## 123 10464   3702       0.029       0.001        0.000000       62.20833
    ## 124 10465   3709       0.005       0.001       43.544444       64.82500
    ## 125 10465   3703       0.995       0.365       43.544444       64.82500
    ## 126 10466   3702       1.000       0.490       41.012500       80.34000
    ## 127 10467   3702       0.256       0.179       37.514286       92.64000
    ## 128 10467   3704       0.333       0.261       37.514286       92.64000
    ## 129 10467   3706       0.412       0.314       37.514286       92.64000
    ## 130 10468   3706       0.476       0.284       33.725000       81.86000
    ## 131 10468   3701       0.372       0.261       33.725000       81.86000
    ## 132 10468   3707       0.153       0.087       33.725000       81.86000
    ## 133 10469   3705       0.013       0.006       57.375000       85.73000
    ## 134 10469   3703       0.060       0.035       57.375000       85.73000
    ## 135 10469   3704       0.483       0.260       57.375000       85.73000
    ## 136 10469   3702       0.444       0.214       57.375000       85.73000
    ## 137 10470   3702       1.000       0.111       18.533333       64.36000
    ## 138 10471   3701       1.000       0.212       51.354545       68.02000
    ## 139 10471   3702       0.000       0.000       51.354545       68.02000
    ## 140 10472   3709       1.000       0.366       43.100000       89.29000
    ## 141 10473   3709       1.000       0.323       35.100000       88.82000
    ## 142 10474   3710       1.000       0.079       22.275000       82.54118
    ## 143 10475   3702       0.018       0.005       48.769231       93.36500
    ## 144 10475   3703       0.982       0.349       48.769231       93.36500
    ## 145 11004   4105       1.000       0.074       43.983333       60.26842
    ## 146 11101   4101       0.603       0.088       18.180000       46.42000
    ## 147 11101   4109       0.397       0.076       18.180000       46.42000
    ## 148 11102   4101       1.000       0.196       39.100000       71.23000
    ## 149 11103   4109       0.005       0.001       40.533333       48.66000
    ## 150 11103   4101       0.995       0.222       40.533333       48.66000
    ## 151 11104   4109       1.000       0.203       24.300000       55.03333
    ## 152 11105   4101       1.000       0.211       27.011111       47.98421
    ## 153 11106   4101       1.000       0.223       33.400000       53.98000
    ## 154 11109   4109       1.000       0.026        0.000000       38.21000
    ## 155 11201   4005       0.106       0.051       27.633333       33.11579
    ## 156 11201   4004       0.894       0.386       27.633333       33.11579
    ## 157 11203   4011       0.195       0.138       31.770588       80.54000
    ## 158 11203   4009       0.011       0.004       31.770588       80.54000
    ## 159 11203   4010       0.795       0.446       31.770588       80.54000
    ## 160 11204   4017       0.635       0.273       24.278571       59.94500
    ## 161 11204   4014       0.365       0.174       24.278571       59.94500
    ## 162 11205   4004       0.700       0.238       14.875000       48.09000
    ## 163 11205   4003       0.300       0.090       14.875000       48.09000
    ## 164 11206   4001       0.251       0.139       31.950000       59.22000
    ## 165 11206   4002       0.285       0.180       31.950000       59.22000
    ## 166 11206   4003       0.464       0.282       31.950000       59.22000
    ## 167 11207   4002       0.186       0.135       30.160000       77.33000
    ## 168 11207   4008       0.491       0.297       30.160000       77.33000
    ## 169 11207   4009       0.008       0.004       30.160000       77.33000
    ## 170 11207   4007       0.314       0.246       30.160000       77.33000
    ## 171 11208   4008       1.000       0.611       37.508333       83.60000
    ## 172 11209   4013       1.000       0.565       27.445455       51.76000
    ## 173 11210   4010       0.188       0.086       30.591667       64.76500
    ## 174 11210   4009       0.330       0.106       30.591667       64.76500
    ## 175 11210   4016       0.002       0.001       30.591667       64.76500
    ## 176 11210   4015       0.481       0.188       30.591667       64.76500
    ## 177 11211   4002       0.000       0.000       15.535714       47.67000
    ## 178 11211   4001       1.000       0.611       15.535714       47.67000
    ## 179 11211   4004       0.000       0.000       15.535714       47.67000
    ## 180 11212   4010       0.297       0.185       43.064286       98.29000
    ## 181 11212   4011       0.010       0.008       43.064286       98.29000
    ## 182 11212   4007       0.693       0.490       43.064286       98.29000
    ## 183 11213   4006       0.771       0.400       36.383333       72.83500
    ## 184 11213   4011       0.229       0.136       36.383333       72.83500
    ## 185 11214   4018       0.096       0.074       40.154545       67.61000
    ## 186 11214   4017       0.904       0.441       40.154545       67.61000
    ## 187 11215   4005       0.843       0.505       13.287500       20.92632
    ## 188 11215   4012       0.157       0.068       13.287500       20.92632
    ## 189 11216   4006       0.442       0.195       23.718182       44.69000
    ## 190 11216   4003       0.509       0.206       23.718182       44.69000
    ## 191 11216   4004       0.050       0.023       23.718182       44.69000
    ## 192 11217   4004       0.557       0.168       52.340000       41.32632
    ## 193 11217   4005       0.358       0.121       52.340000       41.32632
    ## 194 11217   4006       0.086       0.025       52.340000       41.32632
    ## 195 11218   4005       0.000       0.000       33.663636       66.82000
    ## 196 11218   4012       0.190       0.097       33.663636       66.82000
    ## 197 11218   4015       0.134       0.064       33.663636       66.82000
    ## 198 11218   4014       0.676       0.311       33.663636       66.82000
    ## 199 11219   4017       0.049       0.025       30.390909       67.32000
    ## 200 11219   4013       0.157       0.119       30.390909       67.32000
    ## 201 11219   4012       0.105       0.065       30.390909       67.32000
    ## 202 11219   4014       0.689       0.389       30.390909       67.32000
    ## 203 11220   4012       0.865       0.585       26.975000       63.84500
    ## 204 11220   4014       0.002       0.001       26.975000       63.84500
    ## 205 11220   4013       0.133       0.108       26.975000       63.84500
    ## 206 11221   4003       0.510       0.300       26.069231       55.02500
    ## 207 11221   4002       0.490       0.299       26.069231       55.02500
    ## 208 11222   4001       1.000       0.250       14.444444       31.56000
    ## 209 11223   4016       0.354       0.189       25.507692       63.81000
    ## 210 11223   4018       0.254       0.175       25.507692       63.81000
    ## 211 11223   4017       0.391       0.170       25.507692       63.81000
    ## 212 11224   4018       1.000       0.415       64.266667      122.00500
    ## 213 11225   4011       1.000       0.530       37.390000       58.07000
    ## 214 11225   4005       0.000       0.000       37.390000       58.07000
    ## 215 11226   4015       0.521       0.334       41.341667       72.82500
    ## 216 11226   4010       0.282       0.211       41.341667       72.82500
    ## 217 11226   4011       0.197       0.187       41.341667       72.82500
    ## 218 11228   4013       0.604       0.207       29.450000       49.12500
    ## 219 11228   4017       0.396       0.091       29.450000       49.12500
    ## 220 11229   4009       0.013       0.005       33.525000       63.86000
    ## 221 11229   4016       0.981       0.531       33.525000       63.86000
    ## 222 11229   4015       0.006       0.003       33.525000       63.86000
    ## 223 11230   4015       0.756       0.412       37.850000       80.14500
    ## 224 11230   4016       0.007       0.004       37.850000       80.14500
    ## 225 11230   4014       0.236       0.125       37.850000       80.14500
    ## 226 11231   4004       0.020       0.006       12.645455       31.05000
    ## 227 11231   4005       0.980       0.308       12.645455       31.05000
    ## 228 11232   4012       0.965       0.185       16.925000       56.68000
    ## 229 11232   4005       0.035       0.009       16.925000       56.68000
    ## 230 11233   4006       0.302       0.165       29.600000       62.49000
    ## 231 11233   4007       0.466       0.262       29.600000       62.49000
    ## 232 11233   4003       0.232       0.116       29.600000       62.49000
    ## 233 11234   4009       1.000       0.453       28.623077       58.47500
    ## 234 11234   4010       0.000       0.000       28.623077       58.47500
    ## 235 11235   4018       0.487       0.336       50.593750      107.23500
    ## 236 11235   4016       0.513       0.275       50.593750      107.23500
    ## 237 11236   4008       0.008       0.005       39.883333       71.96500
    ## 238 11236   4007       0.004       0.003       39.883333       71.96500
    ## 239 11236   4010       0.104       0.072       39.883333       71.96500
    ## 240 11236   4009       0.884       0.428       39.883333       71.96500
    ## 241 11237   4002       1.000       0.386       28.590909       56.98500
    ## 242 11237   4001       0.000       0.000       28.590909       56.98500
    ## 243 11238   4006       0.539       0.216       24.108333       45.19500
    ## 244 11238   4005       0.012       0.006       24.108333       45.19500
    ## 245 11238   4004       0.431       0.179       24.108333       45.19500
    ## 246 11238   4003       0.018       0.006       24.108333       45.19500
    ## 247 11239   4008       1.000       0.087       83.300000      154.35500
    ## 248 11354   4103       1.000       0.221       73.845455       98.02500
    ## 249 11355   4103       1.000       0.346       39.941667       90.49000
    ## 250 11356   4103       1.000       0.094       17.533333       69.02500
    ## 251 11357   4103       1.000       0.158       35.927273       66.35263
    ## 252 11358   4104       0.383       0.123       17.116667       50.11000
    ## 253 11358   4103       0.617       0.093       17.116667       50.11000
    ## 254 11360   4103       0.784       0.060       27.690909       59.71053
    ## 255 11360   4104       0.216       0.035       27.690909       59.71053
    ## 256 11361   4104       1.000       0.245       36.025000       56.25556
    ## 257 11362   4104       1.000       0.153       33.136364       54.55000
    ## 258 11363   4104       1.000       0.060        8.910000       59.36000
    ## 259 11364   4106       0.002       0.000       16.500000       43.88889
    ## 260 11364   4104       0.998       0.295       16.500000       43.88889
    ## 261 11365   4104       0.181       0.065       22.342857       58.97895
    ## 262 11365   4106       0.747       0.205       22.342857       58.97895
    ## 263 11365   4103       0.072       0.012       22.342857       58.97895
    ## 264 11366   4106       1.000       0.088       30.157143       60.99444
    ## 265 11367   4103       0.096       0.016       22.950000       67.11000
    ## 266 11367   4107       0.000       0.000       22.950000       67.11000
    ## 267 11367   4106       0.903       0.241       22.950000       67.11000
    ## 268 11368   4103       0.000       0.000       44.916667      100.42000
    ## 269 11368   4102       0.472       0.283       44.916667      100.42000
    ## 270 11368   4107       0.528       0.397       44.916667      100.42000
    ## 271 11369   4102       1.000       0.211       61.475000      124.29500
    ## 272 11370   4101       0.164       0.037       25.653846       75.20500
    ## 273 11370   4102       0.556       0.120       25.653846       75.20500
    ## 274 11370   3710       0.279       0.071       25.653846       75.20500
    ## 275 11372   4109       0.002       0.001       54.090909       92.95000
    ## 276 11372   4107       0.000       0.000       54.090909       92.95000
    ## 277 11372   4102       0.998       0.363       54.090909       92.95000
    ## 278 11373   4107       0.874       0.603       39.008333       88.58500
    ## 279 11373   4109       0.118       0.088       39.008333       88.58500
    ## 280 11373   4110       0.000       0.000       39.008333       88.58500
    ## 281 11373   4108       0.008       0.008       39.008333       88.58500
    ## 282 11374   4110       0.028       0.007       31.616667       75.49000
    ## 283 11374   4108       0.972       0.379       31.616667       75.49000
    ## 284 11375   4107       0.000       0.000       29.564286       58.23000
    ## 285 11375   4108       1.000       0.614       29.564286       58.23000
    ## 286 11377   4102       0.047       0.023       32.400000       74.00500
    ## 287 11377   4109       0.898       0.602       32.400000       74.00500
    ## 288 11377   4101       0.045       0.023       32.400000       74.00500
    ## 289 11377   4110       0.010       0.005       32.400000       74.00500
    ## 290 11378   4109       0.005       0.001       31.462500       58.65500
    ## 291 11378   4110       0.995       0.204       31.462500       58.65500
    ## 292 11379   4110       1.000       0.204       49.100000       71.38000
    ## 293 11385   4110       1.000       0.579       20.183333       53.52000
    ## 294 11411   4105       0.973       0.096       32.222222       81.61111
    ## 295 11411   4112       0.027       0.002       32.222222       81.61111
    ## 296 11412   4112       0.952       0.150       30.190000       69.29500
    ## 297 11412   4105       0.048       0.009       30.190000       69.29500
    ## 298 11413   4105       0.831       0.171       26.876923       72.45000
    ## 299 11413   4112       0.169       0.030       26.876923       72.45000
    ## 300 11414   4113       1.000       0.212       31.235714       69.30000
    ## 301 11415   4111       1.000       0.135       29.753846       74.72000
    ## 302 11416   4113       0.029       0.006       32.363636       76.18500
    ## 303 11416   4111       0.971       0.169       32.363636       76.18500
    ## 304 11417   4111       0.041       0.008       25.130000       69.26000
    ## 305 11417   4113       0.959       0.225       25.130000       69.26000
    ## 306 11418   4111       1.000       0.253       24.521429       69.97000
    ## 307 11419   4111       0.487       0.161       28.715385       79.47500
    ## 308 11419   4113       0.513       0.196       28.715385       79.47500
    ## 309 11420   4113       1.000       0.359       29.100000       73.80000
    ## 310 11421   4111       1.000       0.274       32.284615       72.80000
    ## 311 11422   4105       1.000       0.161       24.223077       75.02000
    ## 312 11423   4106       0.247       0.048       47.658333       82.23000
    ## 313 11423   4112       0.753       0.102       47.658333       82.23000
    ## 314 11426   4105       1.000       0.093       20.281818       56.12632
    ## 315 11427   4104       0.122       0.025       23.909091       67.63333
    ## 316 11427   4112       0.006       0.001       23.909091       67.63333
    ## 317 11427   4106       0.206       0.031       23.909091       67.63333
    ## 318 11427   4105       0.667       0.083       23.909091       67.63333
    ## 319 11428   4112       0.017       0.001       40.370000       91.19444
    ## 320 11428   4105       0.983       0.100       40.370000       91.19444
    ## 321 11429   4112       0.014       0.002       32.653846       84.86500
    ## 322 11429   4105       0.986       0.131       32.653846       84.86500
    ## 323 11432   4112       0.418       0.115       47.100000       89.46500
    ## 324 11432   4106       0.582       0.230       47.100000       89.46500
    ## 325 11433   4112       1.000       0.148       34.225000       86.11500
    ## 326 11434   4105       0.117       0.037       34.678571       78.65000
    ## 327 11434   4112       0.883       0.236       34.678571       78.65000
    ## 328 11435   4112       0.551       0.133       34.241667       76.52500
    ## 329 11435   4106       0.449       0.157       34.241667       76.52500
    ## 330 11436   4112       1.000       0.081       31.033333       76.33500
    ## 331 11691   4114       1.000       0.522       66.191667      102.60000
    ## 332 11692   4114       1.000       0.161       59.440000       82.84737
    ## 333 11693   4114       1.000       0.104       28.690909       61.74706
    ## 334 11694   4114       1.000       0.177       68.757143       85.01333
    ## 335 11697   4114       1.000       0.035        0.000000       86.60000
    ##     perc_1plus
    ## 1       132.18
    ## 2        88.06
    ## 3        78.48
    ## 4        78.48
    ## 5        78.48
    ## 6        78.48
    ## 7       141.68
    ## 8        97.51
    ## 9       141.02
    ## 10      100.95
    ## 11      100.95
    ## 12       79.43
    ## 13       79.43
    ## 14       78.11
    ## 15       78.11
    ## 16       84.40
    ## 17       84.40
    ## 18       78.61
    ## 19       88.15
    ## 20       88.15
    ## 21       83.53
    ## 22       83.53
    ## 23       96.36
    ## 24       96.36
    ## 25      116.26
    ## 26      116.26
    ## 27      207.38
    ## 28      124.32
    ## 29      124.32
    ## 30       78.65
    ## 31       99.56
    ## 32       99.56
    ## 33       99.56
    ## 34       86.29
    ## 35       80.97
    ## 36       80.97
    ## 37       79.80
    ## 38       79.80
    ## 39       65.77
    ## 40       65.77
    ## 41       69.39
    ## 42       69.39
    ## 43       76.22
    ## 44       72.71
    ## 45       63.37
    ## 46       63.37
    ## 47       69.73
    ## 48       71.55
    ## 49       71.55
    ## 50       68.64
    ## 51       67.66
    ## 52       75.11
    ## 53       75.11
    ## 54      163.40
    ## 55       68.09
    ## 56       68.09
    ## 57       87.16
    ## 58       87.16
    ## 59       64.35
    ## 60       64.35
    ## 61       69.80
    ## 62       78.71
    ## 63       87.34
    ## 64       91.35
    ## 65       91.12
    ## 66       81.20
    ## 67       81.20
    ## 68       72.19
    ## 69       71.72
    ## 70       73.40
    ## 71       73.40
    ## 72       74.91
    ## 73       68.69
    ## 74       68.69
    ## 75       75.08
    ## 76       75.08
    ## 77       73.93
    ## 78       73.93
    ## 79       75.84
    ## 80       75.84
    ## 81       58.86
    ## 82       63.06
    ## 83       65.18
    ## 84       75.45
    ## 85       67.01
    ## 86       67.01
    ## 87       67.41
    ## 88       67.41
    ## 89       67.41
    ## 90       76.85
    ## 91       76.85
    ## 92       76.85
    ## 93       72.96
    ## 94       72.96
    ## 95       69.95
    ## 96       69.95
    ## 97       69.81
    ## 98       69.62
    ## 99       65.60
    ## 100      65.60
    ## 101      65.60
    ## 102      69.60
    ## 103      69.60
    ## 104      69.60
    ## 105      66.67
    ## 106      66.67
    ## 107      66.67
    ## 108      69.97
    ## 109      69.97
    ## 110      66.36
    ## 111      66.36
    ## 112      66.36
    ## 113      80.17
    ## 114      80.17
    ## 115      80.17
    ## 116      78.66
    ## 117      78.66
    ## 118      78.66
    ## 119      73.56
    ## 120      73.56
    ## 121      73.56
    ## 122      75.84
    ## 123      75.84
    ## 124      65.59
    ## 125      65.59
    ## 126      61.97
    ## 127      68.09
    ## 128      68.09
    ## 129      68.09
    ## 130      68.79
    ## 131      68.79
    ## 132      68.79
    ## 133      63.42
    ## 134      63.42
    ## 135      63.42
    ## 136      63.42
    ## 137      69.12
    ## 138      78.43
    ## 139      78.43
    ## 140      71.16
    ## 141      67.21
    ## 142      64.33
    ## 143      68.21
    ## 144      68.21
    ## 145      74.97
    ## 146     104.11
    ## 147     104.11
    ## 148      92.29
    ## 149      82.93
    ## 150      82.93
    ## 151      88.12
    ## 152      73.65
    ## 153      84.92
    ## 154      93.69
    ## 155      86.62
    ## 156      86.62
    ## 157      68.04
    ## 158      68.04
    ## 159      68.04
    ## 160      63.80
    ## 161      63.80
    ## 162      55.60
    ## 163      55.60
    ## 164      58.43
    ## 165      58.43
    ## 166      58.43
    ## 167      65.63
    ## 168      65.63
    ## 169      65.63
    ## 170      65.63
    ## 171      67.56
    ## 172      75.34
    ## 173      57.01
    ## 174      57.01
    ## 175      57.01
    ## 176      57.01
    ## 177      58.19
    ## 178      58.19
    ## 179      58.19
    ## 180      67.95
    ## 181      67.95
    ## 182      67.95
    ## 183      58.10
    ## 184      58.10
    ## 185      72.65
    ## 186      72.65
    ## 187      74.28
    ## 188      74.28
    ## 189      70.82
    ## 190      70.82
    ## 191      70.82
    ## 192      73.43
    ## 193      73.43
    ## 194      73.43
    ## 195      66.49
    ## 196      66.49
    ## 197      66.49
    ## 198      66.49
    ## 199      49.06
    ## 200      49.06
    ## 201      49.06
    ## 202      49.06
    ## 203      96.66
    ## 204      96.66
    ## 205      96.66
    ## 206      70.93
    ## 207      70.93
    ## 208      83.42
    ## 209      61.50
    ## 210      61.50
    ## 211      61.50
    ## 212      60.48
    ## 213      66.76
    ## 214      66.76
    ## 215      71.69
    ## 216      71.69
    ## 217      71.69
    ## 218      71.78
    ## 219      71.78
    ## 220      62.53
    ## 221      62.53
    ## 222      62.53
    ## 223      56.21
    ## 224      56.21
    ## 225      56.21
    ## 226      69.81
    ## 227      69.81
    ## 228      77.32
    ## 229      77.32
    ## 230      57.42
    ## 231      57.42
    ## 232      57.42
    ## 233      60.73
    ## 234      60.73
    ## 235      70.53
    ## 236      70.53
    ## 237      61.54
    ## 238      61.54
    ## 239      61.54
    ## 240      61.54
    ## 241      79.53
    ## 242      79.53
    ## 243      81.70
    ## 244      81.70
    ## 245      81.70
    ## 246      81.70
    ## 247      87.99
    ## 248      96.65
    ## 249     107.44
    ## 250      94.44
    ## 251      80.45
    ## 252      90.98
    ## 253      90.98
    ## 254      81.25
    ## 255      81.25
    ## 256      87.59
    ## 257      80.53
    ## 258      82.59
    ## 259      82.96
    ## 260      82.96
    ## 261      81.52
    ## 262      81.52
    ## 263      81.52
    ## 264      76.29
    ## 265      69.69
    ## 266      69.69
    ## 267      69.69
    ## 268      90.75
    ## 269      90.75
    ## 270      90.75
    ## 271      94.04
    ## 272      75.25
    ## 273      75.25
    ## 274      75.25
    ## 275     100.70
    ## 276     100.70
    ## 277     100.70
    ## 278     102.81
    ## 279     102.81
    ## 280     102.81
    ## 281     102.81
    ## 282      81.68
    ## 283      81.68
    ## 284      73.81
    ## 285      73.81
    ## 286      89.51
    ## 287      89.51
    ## 288      89.51
    ## 289      89.51
    ## 290      74.70
    ## 291      74.70
    ## 292      70.96
    ## 293      69.56
    ## 294      63.72
    ## 295      63.72
    ## 296      65.34
    ## 297      65.34
    ## 298      61.82
    ## 299      61.82
    ## 300      63.83
    ## 301      75.46
    ## 302      80.15
    ## 303      80.15
    ## 304      79.48
    ## 305      79.48
    ## 306      77.77
    ## 307      82.52
    ## 308      82.52
    ## 309      77.04
    ## 310      81.46
    ## 311      63.79
    ## 312      77.19
    ## 313      77.19
    ## 314      74.60
    ## 315      88.83
    ## 316      88.83
    ## 317      88.83
    ## 318      88.83
    ## 319      84.68
    ## 320      84.68
    ## 321      63.08
    ## 322      63.08
    ## 323      87.44
    ## 324      87.44
    ## 325      69.94
    ## 326      64.60
    ## 327      64.60
    ## 328      74.62
    ## 329      74.62
    ## 330      71.26
    ## 331      53.66
    ## 332      58.75
    ## 333      59.63
    ## 334      64.14
    ## 335      98.27

``` r
outcome_puma <- 
  merge(zcta_puma_clean, merged_outcomes, by = "zcta") %>%
  mutate(weighted_death_rate =  
           death_rate_mean * per_in_puma * per_of_puma,
         weighted_hosp_rate =
           hosp_rate_mean * per_in_puma * per_of_puma,
         weighted_vacc_rate = 
           perc_1plus * per_in_puma * per_of_puma) %>% 
  select(weighted_death_rate,
         weighted_hosp_rate,
         weighted_vacc_rate,
         puma10) %>%
  group_by(puma10) %>%
  summarise(puma_death_rate = sum(weighted_death_rate),
            puma_hosp_rate = sum(weighted_hosp_rate),
            puma_vacc_rate = sum(weighted_vacc_rate)) 
  
outcome_puma %>% pull(puma10) %>% n_distinct() # merged result has the same number of puma as that of original number!
```

    ## [1] 55

``` r
head(outcome_puma)
```

    ## # A tibble: 6 x 4
    ##   puma10 puma_death_rate puma_hosp_rate puma_vacc_rate
    ##    <dbl>           <dbl>          <dbl>          <dbl>
    ## 1   3701            34.1           53.2           55.8
    ## 2   3702            29.3           58.9           47.2
    ## 3   3703            36.0           66.5           58.3
    ## 4   3704            16.7           34.6           29.4
    ## 5   3705            16.3           41.3           33.2
    ## 6   3706            15.3           38.6           33.0

``` r
write_csv(outcome_puma, "../data/outcome_puma.csv")
```

### Zip to Zcta

``` r
#tidying zcta_zip_cross data
zip_to_zcta <-
  zcta_zip_cross %>%
  select(zipcode, zcta5) %>%
  rename(zcta = zcta5) %>% 
  mutate(zcta = as.character(zcta))

#selecting needed variables from zcta_puma_clean data
zcta_puma_3 <- 
  zcta_puma_clean %>%
  select(zcta, puma10)
```

### try to see what zcta values are different

``` r
a <- zip_to_zcta %>% mutate(zcta = as.numeric(zcta)) %>% pull(zcta) %>% sort() %>% unique()

b <- zcta_puma_3 %>% mutate(zcta = as.numeric(zcta)) %>% pull(zcta) %>% sort() %>% unique()


# The issue here is that we have 214 unique ZCTAs in the zip to ZCTA crosswalk file (a), but
# only 211 in the ZCTA to PUMA crosswalk file (b).
# The missing ZCTAs are: 11001, 11003, 11040. We should find out which zip codes correspond to these
# missing ZCTAs in the nyc_broadband data set, and see what the data is.

a[which((a %in% b) == FALSE)] # showing missing 3 ZCTAs
```

    ## [1] 11001 11003 11040

``` r
result_zip_to_zcta <- 
  merge(zip_to_zcta, zcta_puma_3, by = "zcta") %>% relocate(zipcode) #turning zip into zcta 

result_zip_to_zcta %>% pull(zcta) %>% n_distinct() #count the number of unique ZCTAs
```

    ## [1] 211

``` r
result_zip_to_zcta #showing the result
```

    ##     zipcode  zcta puma10
    ## 1     10118 10001   3807
    ## 2     10001 10001   3807
    ## 3     10125 10001   3807
    ## 4     10130 10001   3807
    ## 5     10122 10001   3807
    ## 6     10123 10001   3807
    ## 7     10120 10001   3807
    ## 8     10002 10002   3809
    ## 9     10276 10003   3809
    ## 10    10276 10003   3810
    ## 11    10276 10003   3808
    ## 12    10276 10003   3807
    ## 13    10114 10003   3809
    ## 14    10114 10003   3810
    ## 15    10114 10003   3808
    ## 16    10114 10003   3807
    ## 17    10003 10003   3809
    ## 18    10003 10003   3810
    ## 19    10003 10003   3808
    ## 20    10003 10003   3807
    ## 21    10274 10004   3810
    ## 22    10004 10004   3810
    ## 23    10045 10004   3810
    ## 24    10041 10004   3810
    ## 25    10275 10004   3810
    ## 26    10081 10005   3810
    ## 27    10203 10005   3810
    ## 28    10260 10005   3810
    ## 29    10265 10005   3810
    ## 30    10268 10005   3810
    ## 31    10270 10005   3810
    ## 32    10286 10005   3810
    ## 33    10269 10005   3810
    ## 34    10005 10005   3810
    ## 35    10043 10005   3810
    ## 36    10257 10005   3810
    ## 37    10006 10006   3810
    ## 38    10256 10006   3810
    ## 39    10242 10007   3809
    ## 40    10242 10007   3810
    ## 41    10249 10007   3809
    ## 42    10249 10007   3810
    ## 43    10007 10007   3809
    ## 44    10007 10007   3810
    ## 45    10008 10007   3809
    ## 46    10008 10007   3810
    ## 47    10009 10009   3809
    ## 48    10009 10009   3808
    ## 49    10159 10010   3808
    ## 50    10159 10010   3807
    ## 51    10160 10010   3808
    ## 52    10160 10010   3807
    ## 53    10010 10010   3808
    ## 54    10010 10010   3807
    ## 55    10011 10011   3807
    ## 56    10011 10011   3810
    ## 57    10113 10011   3807
    ## 58    10113 10011   3810
    ## 59    10161 10011   3807
    ## 60    10161 10011   3810
    ## 61    10012 10012   3810
    ## 62    10013 10013   3810
    ## 63    10013 10013   3809
    ## 64    10213 10013   3810
    ## 65    10213 10013   3809
    ## 66    10014 10014   3807
    ## 67    10014 10014   3810
    ## 68    10138 10016   3808
    ## 69    10138 10016   3807
    ## 70    10156 10016   3808
    ## 71    10156 10016   3807
    ## 72    10016 10016   3808
    ## 73    10016 10016   3807
    ## 74    10158 10016   3808
    ## 75    10158 10016   3807
    ## 76    10157 10016   3808
    ## 77    10157 10016   3807
    ## 78    10087 10017   3807
    ## 79    10087 10017   3808
    ## 80    10017 10017   3807
    ## 81    10017 10017   3808
    ## 82    10175 10017   3807
    ## 83    10175 10017   3808
    ## 84    10163 10017   3807
    ## 85    10163 10017   3808
    ## 86    10166 10017   3807
    ## 87    10166 10017   3808
    ## 88    10261 10017   3807
    ## 89    10261 10017   3808
    ## 90    10164 10017   3807
    ## 91    10164 10017   3808
    ## 92    10179 10017   3807
    ## 93    10179 10017   3808
    ## 94    10259 10017   3807
    ## 95    10259 10017   3808
    ## 96    10178 10017   3807
    ## 97    10178 10017   3808
    ## 98    10018 10018   3807
    ## 99    10129 10018   3807
    ## 100   10102 10019   3807
    ## 101   10102 10019   3806
    ## 102   10101 10019   3807
    ## 103   10101 10019   3806
    ## 104   10107 10019   3807
    ## 105   10107 10019   3806
    ## 106   10104 10019   3807
    ## 107   10104 10019   3806
    ## 108   10019 10019   3807
    ## 109   10019 10019   3806
    ## 110   10106 10019   3807
    ## 111   10106 10019   3806
    ## 112   10105 10019   3807
    ## 113   10105 10019   3806
    ## 114   10020 10020   3807
    ## 115   10131 10021   3805
    ## 116   10021 10021   3805
    ## 117   10055 10022   3808
    ## 118   10055 10022   3805
    ## 119   10055 10022   3807
    ## 120   10155 10022   3808
    ## 121   10155 10022   3805
    ## 122   10155 10022   3807
    ## 123   10150 10022   3808
    ## 124   10150 10022   3805
    ## 125   10150 10022   3807
    ## 126   10151 10022   3808
    ## 127   10151 10022   3805
    ## 128   10151 10022   3807
    ## 129   10022 10022   3808
    ## 130   10022 10022   3805
    ## 131   10022 10022   3807
    ## 132   10126 10022   3808
    ## 133   10126 10022   3805
    ## 134   10126 10022   3807
    ## 135   10023 10023   3806
    ## 136   10133 10023   3806
    ## 137   10132 10024   3806
    ## 138   10132 10024   3802
    ## 139   10024 10024   3806
    ## 140   10024 10024   3802
    ## 141   10025 10025   3802
    ## 142   10025 10025   3806
    ## 143   10026 10026   3803
    ## 144   10026 10026   3802
    ## 145   10116 10027   3803
    ## 146   10116 10027   3802
    ## 147   10027 10027   3803
    ## 148   10027 10027   3802
    ## 149   10028 10028   3805
    ## 150   10029 10029   3804
    ## 151   10030 10030   3802
    ## 152   10030 10030   3803
    ## 153   10031 10031   3802
    ## 154   10032 10032   3801
    ## 155   10032 10032   3802
    ## 156   10033 10033   3801
    ## 157   10034 10034   3801
    ## 158   10035 10035   3803
    ## 159   10035 10035   3804
    ## 160   10108 10036   3807
    ## 161   10036 10036   3807
    ## 162   10185 10036   3807
    ## 163   10176 10036   3807
    ## 164   10109 10036   3807
    ## 165   10037 10037   3803
    ## 166   10037 10037   3804
    ## 167   10038 10038   3810
    ## 168   10038 10038   3809
    ## 169   10273 10038   3810
    ## 170   10273 10038   3809
    ## 171   10292 10038   3810
    ## 172   10292 10038   3809
    ## 173   10272 10038   3810
    ## 174   10272 10038   3809
    ## 175   10039 10039   3803
    ## 176   10039 10039   3801
    ## 177   10040 10040   3801
    ## 178   10044 10044   3805
    ## 179   10065 10065   3805
    ## 180   10069 10069   3806
    ## 181   10075 10075   3805
    ## 182   10103 10103   3807
    ## 183   10110 10110   3807
    ## 184   10111 10111   3807
    ## 185   10112 10112   3807
    ## 186   10115 10115   3802
    ## 187   10119 10119   3807
    ## 188   10121 10119   3807
    ## 189   10117 10119   3807
    ## 190   10128 10128   3805
    ## 191   10128 10128   3804
    ## 192   10124 10152   3808
    ## 193   10152 10152   3808
    ## 194   10153 10153   3807
    ## 195   10154 10154   3808
    ## 196   10162 10162   3805
    ## 197   10165 10165   3808
    ## 198   10167 10167   3808
    ## 199   10168 10168   3808
    ## 200   10169 10169   3808
    ## 201   10170 10170   3808
    ## 202   10171 10171   3808
    ## 203   10172 10172   3808
    ## 204   10173 10173   3807
    ## 205   10174 10174   3808
    ## 206   10177 10177   3807
    ## 207   10090 10199   3807
    ## 208   10060 10199   3807
    ## 209   10212 10199   3807
    ## 210   10199 10199   3807
    ## 211   10211 10199   3807
    ## 212   10095 10199   3807
    ## 213   10258 10271   3810
    ## 214   10271 10271   3810
    ## 215   10278 10278   3810
    ## 216   10277 10278   3810
    ## 217   10279 10279   3810
    ## 218   10280 10280   3810
    ## 219   10285 10280   3810
    ## 220   10281 10282   3810
    ## 221   10080 10282   3810
    ## 222   10282 10282   3810
    ## 223   10301 10301   3903
    ## 224   10301 10301   3902
    ## 225   10302 10302   3903
    ## 226   10303 10303   3903
    ## 227   10303 10303   3902
    ## 228   10304 10304   3902
    ## 229   10304 10304   3903
    ## 230   10305 10305   3902
    ## 231   10305 10305   3903
    ## 232   10306 10306   3901
    ## 233   10306 10306   3902
    ## 234   10307 10307   3901
    ## 235   10308 10308   3901
    ## 236   10309 10309   3901
    ## 237   10310 10310   3903
    ## 238   10311 10311   3902
    ## 239   10312 10312   3902
    ## 240   10312 10312   3901
    ## 241   10313 10314   3903
    ## 242   10313 10314   3901
    ## 243   10313 10314   3902
    ## 244   10314 10314   3903
    ## 245   10314 10314   3901
    ## 246   10314 10314   3902
    ## 247   10451 10451   3705
    ## 248   10451 10451   3710
    ## 249   10451 10451   3708
    ## 250   10452 10452   3707
    ## 251   10452 10452   3708
    ## 252   10453 10453   3707
    ## 253   10453 10453   3706
    ## 254   10454 10454   3710
    ## 255   10455 10455   3710
    ## 256   10456 10456   3708
    ## 257   10456 10456   3710
    ## 258   10456 10456   3705
    ## 259   10457 10457   3707
    ## 260   10457 10457   3708
    ## 261   10457 10457   3705
    ## 262   10458 10458   3707
    ## 263   10458 10458   3706
    ## 264   10458 10458   3705
    ## 265   10459 10459   3710
    ## 266   10459 10459   3705
    ## 267   10460 10460   3705
    ## 268   10460 10460   3704
    ## 269   10460 10460   3709
    ## 270   10461 10461   3703
    ## 271   10461 10461   3704
    ## 272   10461 10461   3709
    ## 273   10462 10462   3704
    ## 274   10462 10462   3705
    ## 275   10462 10462   3709
    ## 276   10463 10463   3701
    ## 277   10463 10463   3706
    ## 278   10463 10463   3801
    ## 279   10464 10464   3702
    ## 280   10464 10464   3703
    ## 281   10465 10465   3703
    ## 282   10465 10465   3709
    ## 283   10466 10466   3702
    ## 284   10467 10467   3706
    ## 285   10467 10467   3704
    ## 286   10467 10467   3702
    ## 287   10468 10468   3706
    ## 288   10468 10468   3707
    ## 289   10468 10468   3701
    ## 290   10469 10469   3705
    ## 291   10469 10469   3704
    ## 292   10469 10469   3702
    ## 293   10469 10469   3703
    ## 294   10470 10470   3702
    ## 295   10471 10471   3701
    ## 296   10471 10471   3702
    ## 297   10472 10472   3709
    ## 298   10473 10473   3709
    ## 299   10474 10474   3710
    ## 300   10475 10475   3703
    ## 301   10475 10475   3702
    ## 302   11004 11004   4105
    ## 303   11005 11005   4105
    ## 304   11101 11101   4101
    ## 305   11101 11101   4109
    ## 306   11120 11101   4101
    ## 307   11120 11101   4109
    ## 308   11102 11102   4101
    ## 309   11103 11103   4101
    ## 310   11103 11103   4109
    ## 311   11104 11104   4109
    ## 312   11105 11105   4101
    ## 313   11106 11106   4101
    ## 314   11109 11109   4109
    ## 315   11201 11201   4004
    ## 316   11201 11201   4005
    ## 317   11202 11201   4004
    ## 318   11202 11201   4005
    ## 319   11241 11201   4004
    ## 320   11241 11201   4005
    ## 321   11242 11201   4004
    ## 322   11242 11201   4005
    ## 323   11245 11201   4004
    ## 324   11245 11201   4005
    ## 325   11203 11203   4011
    ## 326   11203 11203   4009
    ## 327   11203 11203   4010
    ## 328   11204 11204   4017
    ## 329   11204 11204   4014
    ## 330   11205 11205   4003
    ## 331   11205 11205   4004
    ## 332   11206 11206   4003
    ## 333   11206 11206   4001
    ## 334   11206 11206   4002
    ## 335   11207 11207   4008
    ## 336   11207 11207   4007
    ## 337   11207 11207   4002
    ## 338   11207 11207   4009
    ## 339   11208 11208   4008
    ## 340   11256 11208   4008
    ## 341   11209 11209   4013
    ## 342   11252 11209   4013
    ## 343   11210 11210   4016
    ## 344   11210 11210   4009
    ## 345   11210 11210   4010
    ## 346   11210 11210   4015
    ## 347   11211 11211   4001
    ## 348   11211 11211   4004
    ## 349   11211 11211   4002
    ## 350   11249 11211   4001
    ## 351   11249 11211   4004
    ## 352   11249 11211   4002
    ## 353   11251 11211   4001
    ## 354   11251 11211   4004
    ## 355   11251 11211   4002
    ## 356   11212 11212   4007
    ## 357   11212 11212   4010
    ## 358   11212 11212   4011
    ## 359   11213 11213   4011
    ## 360   11213 11213   4006
    ## 361   11214 11214   4017
    ## 362   11214 11214   4018
    ## 363   11215 11215   4005
    ## 364   11215 11215   4012
    ## 365   11216 11216   4004
    ## 366   11216 11216   4006
    ## 367   11216 11216   4003
    ## 368   11247 11216   4004
    ## 369   11247 11216   4006
    ## 370   11247 11216   4003
    ## 371   11217 11217   4005
    ## 372   11217 11217   4004
    ## 373   11217 11217   4006
    ## 374   11243 11217   4005
    ## 375   11243 11217   4004
    ## 376   11243 11217   4006
    ## 377   11218 11218   4014
    ## 378   11218 11218   4012
    ## 379   11218 11218   4005
    ## 380   11218 11218   4015
    ## 381   11219 11219   4014
    ## 382   11219 11219   4013
    ## 383   11219 11219   4017
    ## 384   11219 11219   4012
    ## 385   11220 11220   4013
    ## 386   11220 11220   4014
    ## 387   11220 11220   4012
    ## 388   11221 11221   4003
    ## 389   11221 11221   4002
    ## 390   11222 11222   4001
    ## 391   11223 11223   4016
    ## 392   11223 11223   4017
    ## 393   11223 11223   4018
    ## 394   11224 11224   4018
    ## 395   11225 11225   4011
    ## 396   11225 11225   4005
    ## 397   11226 11226   4010
    ## 398   11226 11226   4015
    ## 399   11226 11226   4011
    ## 400   11228 11228   4013
    ## 401   11228 11228   4017
    ## 402   11229 11229   4009
    ## 403   11229 11229   4016
    ## 404   11229 11229   4015
    ## 405   11230 11230   4015
    ## 406   11230 11230   4016
    ## 407   11230 11230   4014
    ## 408   11231 11231   4004
    ## 409   11231 11231   4005
    ## 410   11232 11232   4012
    ## 411   11232 11232   4005
    ## 412   11233 11233   4003
    ## 413   11233 11233   4006
    ## 414   11233 11233   4007
    ## 415   11234 11234   4009
    ## 416   11234 11234   4010
    ## 417   11235 11235   4016
    ## 418   11235 11235   4018
    ## 419   11236 11236   4010
    ## 420   11236 11236   4007
    ## 421   11236 11236   4009
    ## 422   11236 11236   4008
    ## 423   11237 11237   4001
    ## 424   11237 11237   4002
    ## 425   11238 11238   4003
    ## 426   11238 11238   4006
    ## 427   11238 11238   4004
    ## 428   11238 11238   4005
    ## 429   11239 11239   4008
    ## 430   11351 11351   4103
    ## 431   11354 11354   4103
    ## 432   11352 11355   4103
    ## 433   11355 11355   4103
    ## 434   11356 11356   4103
    ## 435   11357 11357   4103
    ## 436   11358 11358   4103
    ## 437   11358 11358   4104
    ## 438   11359 11359   4103
    ## 439   11360 11360   4104
    ## 440   11360 11360   4103
    ## 441   11361 11361   4104
    ## 442   11362 11362   4104
    ## 443   11363 11363   4104
    ## 444   11364 11364   4106
    ## 445   11364 11364   4104
    ## 446   11365 11365   4106
    ## 447   11365 11365   4103
    ## 448   11365 11365   4104
    ## 449   11366 11366   4106
    ## 450   11367 11367   4106
    ## 451   11367 11367   4107
    ## 452   11367 11367   4103
    ## 453   11368 11368   4102
    ## 454   11368 11368   4103
    ## 455   11368 11368   4107
    ## 456   11369 11369   4102
    ## 457   11370 11370   3710
    ## 458   11370 11370   4101
    ## 459   11370 11370   4102
    ## 460   11371 11371   4102
    ## 461   11372 11372   4102
    ## 462   11372 11372   4109
    ## 463   11372 11372   4107
    ## 464   11373 11373   4110
    ## 465   11373 11373   4108
    ## 466   11373 11373   4107
    ## 467   11373 11373   4109
    ## 468   11380 11373   4110
    ## 469   11380 11373   4108
    ## 470   11380 11373   4107
    ## 471   11380 11373   4109
    ## 472   11374 11374   4110
    ## 473   11374 11374   4108
    ## 474   11375 11375   4108
    ## 475   11375 11375   4107
    ## 476   11377 11377   4102
    ## 477   11377 11377   4109
    ## 478   11377 11377   4101
    ## 479   11377 11377   4110
    ## 480   11378 11378   4110
    ## 481   11378 11378   4109
    ## 482   11379 11379   4110
    ## 483   11381 11379   4110
    ## 484   11385 11385   4110
    ## 485   11386 11385   4110
    ## 486   11411 11411   4112
    ## 487   11411 11411   4105
    ## 488   11412 11412   4112
    ## 489   11412 11412   4105
    ## 490   11413 11413   4105
    ## 491   11413 11413   4112
    ## 492   11414 11414   4113
    ## 493   11415 11415   4111
    ## 494   11416 11416   4111
    ## 495   11416 11416   4113
    ## 496   11417 11417   4113
    ## 497   11417 11417   4111
    ## 498   11418 11418   4111
    ## 499   11419 11419   4111
    ## 500   11419 11419   4113
    ## 501   11420 11420   4113
    ## 502   11421 11421   4111
    ## 503   11422 11422   4105
    ## 504   11423 11423   4112
    ## 505   11423 11423   4106
    ## 506   11424 11424   4111
    ## 507   11425 11425   4013
    ## 508   11426 11426   4105
    ## 509   11427 11427   4105
    ## 510   11427 11427   4112
    ## 511   11427 11427   4106
    ## 512   11427 11427   4104
    ## 513   11428 11428   4105
    ## 514   11428 11428   4112
    ## 515   11429 11429   4105
    ## 516   11429 11429   4112
    ## 517   11430 11430   4113
    ## 518   11430 11430   4105
    ## 519   11499 11430   4113
    ## 520   11499 11430   4105
    ## 521   11431 11432   4106
    ## 522   11431 11432   4112
    ## 523   11432 11432   4106
    ## 524   11432 11432   4112
    ## 525   11439 11432   4106
    ## 526   11439 11432   4112
    ## 527   11405 11433   4112
    ## 528   11433 11433   4112
    ## 529   11434 11434   4105
    ## 530   11434 11434   4112
    ## 531   11435 11435   4112
    ## 532   11435 11435   4106
    ## 533   11436 11436   4112
    ## 534   11451 11451   4112
    ## 535   11690 11691   4114
    ## 536   11691 11691   4114
    ## 537   11692 11692   4114
    ## 538   11693 11693   4114
    ## 539   11695 11693   4114
    ## 540   11694 11694   4114
    ## 541   11697 11697   4114
